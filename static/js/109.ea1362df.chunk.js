(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{1076:function(a,e,t){"use strict";t.r(e);var n=t(0),l=t.n(n),s=t(7),i=t(29),r=t(16),o=t.n(r),c=t(52),m=t.n(c),p=t(131),d=t(27),u=t(41),h=t(195),g=t(196),b=t(6),_=t(9);class E extends n.Component{constructor(a){super(a),this.state={listLokasi:[],listSupplier:[]}}componentDidMount(){Object(_.b)("lokasi-gudang/get/all").then(a=>this.setState({listLokasi:a.data.map(a=>{return{value:a.kode_lokasi_gudang,name:"".concat(a.nama_lokasi_gudang," - (").concat(a.kode_lokasi_gudang,")")}})})),Object(_.b)("supplier/get/all").then(a=>this.setState({listSupplier:a.data.map(a=>{return{value:a.kode_supplier,name:"".concat(a.nama_supplier," - (").concat(a.kode_supplier,")")}})})),Object(_.b)("konversi-barang/generate/no-trx").then(a=>this.props.change("no_pindah",a.data[0].no_pindah))}setLokasi(a){this.setState({lokasi_pilihan:a}),localStorage.setItem("lokasi_pilihan",a)}setSupplier(a){this.setState({supplier_pilihan:a}),localStorage.setItem("supplier_pilihan",a)}render(){return l.a.createElement("div",null,l.a.createElement("form",{onSubmit:this.props.handleSubmit,autoComplete:!0},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-lg-3"},l.a.createElement(h.a,{name:"no_pindah",component:d.c,type:"text",label:"Nomor Pindah",placeholder:"Masukan Nomor Pindah",readOnly:!0})),l.a.createElement("div",{className:"col-lg-3"},l.a.createElement(h.a,{name:"tanggal",component:d.c,type:"date",label:"Tanggal",placeholder:"Masukan Tanggal"})),l.a.createElement("div",{className:"col-lg-3"},l.a.createElement(h.a,{name:"lokasi",component:d.e,options:this.state.listLokasi,label:"LOKASI",placeholder:"PILIH LOKASI",onChange:a=>this.setLokasi(a)})),l.a.createElement("div",{className:"col-lg-3"},l.a.createElement(h.a,{name:"supplier",component:d.e,options:this.state.listSupplier,label:"SUPPLIER",placeholder:"PILIH SUPPLIER",onChange:a=>this.setSupplier(a)}))),l.a.createElement("div",{className:"col-lg-12 mb-5"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-lg-6"},l.a.createElement("div",{className:"text-left"},l.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Simpan ",l.a.createElement("i",{className:"fa fa-paper-plane"})))),l.a.createElement("div",{className:"col-lg-6"},l.a.createElement("div",{className:"text-right"},l.a.createElement("button",{type:"button",className:"btn btn-warning",onClick:()=>this.props.dispatch(Object(b.Wb)()),disabled:!this.state.lokasi_pilihan||!this.state.supplier_pilihan},"Tambah Barang ",l.a.createElement("i",{className:"fa fa-plus ml-3"}))))))))}}E=Object(g.a)({form:"permintaanBarang",enableReinitialize:!0})(E);var k=Object(i.b)(a=>({initialValues:{no_pindah:localStorage.getItem("no_pindah")||""}}),null)(E),S=t(133),N=t(31),v=t(130),j=t(38),O=t(48);const y=Object(n.lazy)(()=>t.e(110).then(t.bind(null,1041)));e.default=Object(i.b)(a=>({konversi_temp:a.stocking.konversi_temp}),null)(class extends l.a.Component{constructor(a){super(a),this.state={isEdit:!1,modalDialog:!1,isLoading:!1,columns:[{dataField:"kode_asal",text:"Kode Asal",sort:!0},{dataField:"qty_asal",text:"Qty"},{dataField:"kode_tujuan",text:"Kode Tujuan"},{dataField:"qty_tujuan",text:"Qty"},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:(a,e)=>{let t={kode_asal:e.kode_asal,nama_barang_asal:e.nama_barang,qty_asal:e.qty,satuan_asal:e.satuan,kode_tujuan:e.kode_tujuan,nama_barang_tujuan:e.nama_barang,qty_tujuan:e.qty,satuan_tujuan:e.satuan};return this.setState({}),l.a.createElement("div",{className:"row text-center"},l.a.createElement("div",{className:"col-12"},l.a.createElement("button",{onClick:()=>this.editModal(t),className:"btn btn-warning mr-3"},"Edit",l.a.createElement("i",{className:"fa fa-edit ml-2"})),l.a.createElement("button",{onClick:()=>this.deleteBarang(e),className:"btn btn-danger"},"Hapus",l.a.createElement("i",{className:"fa fa-trash ml-2"}))))}}]}}deleteBarang(a){o.a.fire({title:"Anda Yakin !!",text:"Ingin Menghapus Data Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(e=>{if(e.isConfirmed){let e=JSON.parse(localStorage.getItem("KonversiBarang_temp"))||[],t=e.findIndex(e=>e.kode_asal===a.kode_asal);e.splice(t,1),localStorage.setItem("KonversiBarang_temp",JSON.stringify(e)||[]),this.props.dispatch(Object(N.i)())}})}componentDidMount(){this.props.dispatch(Object(N.i)()),Object(_.b)("konversi-barang/generate/no-trx").then(a=>localStorage.setItem("no_pindah",a.data[0].no_pindah))}handleSubmit(a){let e=JSON.parse(localStorage.getItem("KonversiBarang_temp"))||[],t={kode_asal:a.kode_asal,nama_barang_asal:a.nama_barang_asal,qty_asal:a.qty_asal,satuan_asal:a.satuan_asal,kode_tujuan:a.kode_tujuan,nama_barang_tujuan:a.nama_barang_tujuan,qty_tujuan:a.qty_tujuan,satuan_tujuan:a.satuan_tujuan};e.push(t),localStorage.setItem("KonversiBarang_temp",JSON.stringify(e)),Object(d.b)("Berhasil Menambahan Data").then(()=>this.props.dispatch(Object(N.i)())).then(()=>this.props.dispatch(Object(b.Tb)()))}sendData(a){let e={no_pindah:a.no_pindah,tanggal:a.tanggal,kode_lokasi_gudang:a.lokasi,kode_supplier:a.supplier,detail_barang:JSON.parse(localStorage.getItem("KonversiBarang_temp"))||[]};console.log(e);const t=[];JSON.parse(localStorage.getItem("KonversiBarang_temp")).forEach((a,e)=>{const n=[++e,a.kode_asal,a.qty_asal,a.kode_tujuan,a.qty_tujuan];t.push(n)});let n=["NO","KODE ASAL","QTY","KODE TUJUAN","QTY"];Object(_.c)("konversi-barang/post-transaksi",e).then(()=>Object(S.a)("Tanggal",a.tanggal,"","","No Bukti",a.no_pindah,"","","ADMIN","01-28-2021","ADMIN",n,"KONVERSI BARANG",t,[],!1)).then(()=>Object(d.b)("Berhasil Konversi barang")).then(()=>Object(j.c)(["no_pindah","lokasi_pilihan","supplier_pilihan","KonversiBarang_temp"])).then(()=>this.props.dispatch(Object(N.i)())).then(()=>this.props.dispatch(Object(O.a)("permintaanBarang"))).catch(a=>"Error : ".concat(a))}render(){return l.a.createElement("div",null,l.a.createElement("ol",{className:"breadcrumb float-xl-right"},l.a.createElement("li",{className:"breadcrumb-item"},l.a.createElement(s.b,{to:"#"},"Data Master")),l.a.createElement("li",{className:"breadcrumb-item active"},"Konversi Barang")),l.a.createElement("h1",{className:"page-header"},"Konversi Barang "),l.a.createElement(u.a,null,l.a.createElement(u.c,null,"Konversi Barang"),l.a.createElement(u.b,null,l.a.createElement("br",null),l.a.createElement("div",{className:"col-lg-12"},l.a.createElement(k,{onSubmit:a=>this.sendData(a)})),l.a.createElement("div",{className:"col-lg-12"},l.a.createElement(v.a,{empty:!0,data:this.props.konversi_temp,columns:this.state.columns,keyField:"kode_asal",textEmpty:"Silahkan Lokasi -> lalu pilih Supplier -> lalu tambah barang"})),l.a.createElement("br",null),l.a.createElement(p.a,{title:this.state.isEdit?"Edit Data Permintaan Barang":"Tambah Data Barang",content:l.a.createElement(n.Suspense,{fallback:l.a.createElement(m.a,{width:"100%",height:50,count:2})},l.a.createElement(y,{onSubmit:a=>this.handleSubmit(a),onSend:this.props.onSend,isEdit:this.state.isEdit}))}))))}})}}]);
//# sourceMappingURL=109.ea1362df.chunk.js.map