(window.webpackJsonp=window.webpackJsonp||[]).push([[110],{1082:function(a,e,t){"use strict";t.r(e);var n=t(0),s=t.n(n),l=t(7),i=t(29),r=t(15),o=t.n(r),c=t(42),p=t.n(c),m=t(131),d=t(18),u=t(41),h=t(197),g=t(198),b=t(5),_=t(9);class E extends n.Component{constructor(a){super(a),this.state={listLokasi:[],listSupplier:[]}}componentDidMount(){this.props.dispatch(Object(b.Vb)()),Object(_.b)("lokasi-gudang/get/all").then(a=>this.setState({listLokasi:a.data.map(a=>{return{value:a.kode_lokasi_gudang,name:"".concat(a.nama_lokasi_gudang," - (").concat(a.kode_lokasi_gudang,")")}})})).then(()=>this.props.dispatch(Object(b.Ub)())),this.props.dispatch(Object(b.Vb)()),Object(_.b)("supplier/get/all").then(a=>this.setState({listSupplier:a.data.map(a=>{return{value:a.kode_supplier,name:"".concat(a.nama_supplier," - (").concat(a.kode_supplier,")")}})})).then(()=>this.props.dispatch(Object(b.Ub)())),Object(_.b)("konversi-barang/generate/no-trx").then(a=>this.props.change("no_pindah",a.data[0].no_pindah))}setLokasi(a){this.setState({lokasi_pilihan:a}),localStorage.setItem("lokasi_pilihan",a)}setSupplier(a){this.setState({supplier_pilihan:a}),localStorage.setItem("supplier_pilihan",a)}render(){return s.a.createElement("div",null,s.a.createElement("form",{onSubmit:this.props.handleSubmit,autoComplete:!0},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-lg-3"},s.a.createElement(h.a,{name:"no_pindah",component:d.c,type:"text",label:"Nomor Pindah",placeholder:"Masukan Nomor Pindah",readOnly:!0})),s.a.createElement("div",{className:"col-lg-3"},s.a.createElement(h.a,{name:"tanggal",component:d.c,type:"date",label:"Tanggal",placeholder:"Masukan Tanggal"})),s.a.createElement("div",{className:"col-lg-3"},s.a.createElement(h.a,{name:"lokasi",component:d.e,options:this.state.listLokasi,label:"LOKASI",placeholder:"PILIH LOKASI",onChange:a=>this.setLokasi(a)})),s.a.createElement("div",{className:"col-lg-3"},s.a.createElement(h.a,{name:"supplier",component:d.e,options:this.state.listSupplier,label:"SUPPLIER",placeholder:"PILIH SUPPLIER",onChange:a=>this.setSupplier(a)}))),s.a.createElement("div",{className:"col-lg-12 mb-5"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-lg-6"},s.a.createElement("div",{className:"text-left"},s.a.createElement("button",{className:"btn btn-primary"},this.props.onSend?s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Menyimpan"):s.a.createElement(s.a.Fragment,null,"Simpan ",s.a.createElement("i",{className:"fa fa-paper-plane ml-3 "}))))),s.a.createElement("div",{className:"col-lg-6"},s.a.createElement("div",{className:"text-right"},s.a.createElement("button",{type:"button",className:"btn btn-warning",onClick:()=>this.props.dispatch(Object(b.Wb)()),disabled:!this.state.lokasi_pilihan||!this.state.supplier_pilihan},"Tambah Barang ",s.a.createElement("i",{className:"fa fa-plus ml-3"}))))))))}}E=Object(g.a)({form:"permintaanBarang",enableReinitialize:!0})(E);var k=Object(i.b)(a=>({initialValues:{no_pindah:localStorage.getItem("no_pindah")||""},onSend:a.datamaster.onSend}),null)(E),S=t(134),j=t(30),N=t(132),O=t(33),v=t(49);const f=Object(n.lazy)(()=>t.e(111).then(t.bind(null,1043)));e.default=Object(i.b)(a=>({konversi_temp:a.stocking.konversi_temp}),null)(class extends s.a.Component{constructor(a){super(a),this.state={isEdit:!1,modalDialog:!1,isLoading:!1,columns:[{dataField:"kode_asal",text:"Kode Asal",sort:!0},{dataField:"qty_asal",text:"Qty"},{dataField:"kode_tujuan",text:"Kode Tujuan"},{dataField:"qty_tujuan",text:"Qty"},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:(a,e)=>{let t={kode_asal:e.kode_asal,nama_barang_asal:e.nama_barang,qty_asal:e.qty,satuan_asal:e.satuan,kode_tujuan:e.kode_tujuan,nama_barang_tujuan:e.nama_barang,qty_tujuan:e.qty,satuan_tujuan:e.satuan};return this.setState({}),s.a.createElement("div",{className:"row text-center"},s.a.createElement("div",{className:"col-12"},s.a.createElement("button",{onClick:()=>this.editModal(t),className:"btn btn-warning mr-3"},"Edit",s.a.createElement("i",{className:"fa fa-edit ml-2"})),s.a.createElement("button",{onClick:()=>this.deleteBarang(e),className:"btn btn-danger"},"Hapus",s.a.createElement("i",{className:"fa fa-trash ml-2"}))))}}]}}deleteBarang(a){o.a.fire({title:"Anda Yakin !!",text:"Ingin Menghapus Data Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(e=>{if(e.isConfirmed){let e=JSON.parse(localStorage.getItem("KonversiBarang_temp"))||[],t=e.findIndex(e=>e.kode_asal===a.kode_asal);e.splice(t,1),localStorage.setItem("KonversiBarang_temp",JSON.stringify(e)||[]),this.props.dispatch(Object(j.i)())}})}componentDidMount(){this.props.dispatch(Object(j.i)()),Object(_.b)("konversi-barang/generate/no-trx").then(a=>localStorage.setItem("no_pindah",a.data[0].no_pindah))}handleSubmit(a){let e=JSON.parse(localStorage.getItem("KonversiBarang_temp"))||[],t={kode_asal:a.kode_asal,nama_barang_asal:a.nama_barang_asal,qty_asal:a.qty_asal,satuan_asal:a.satuan_asal,kode_tujuan:a.kode_tujuan,nama_barang_tujuan:a.nama_barang_tujuan,qty_tujuan:a.qty_tujuan,satuan_tujuan:a.satuan_tujuan};e.push(t),localStorage.setItem("KonversiBarang_temp",JSON.stringify(e)),Object(d.b)("Berhasil Menambahan Data").then(()=>this.props.dispatch(Object(j.i)())).then(()=>this.props.dispatch(Object(b.Tb)()))}sendData(a){this.props.dispatch(Object(b.Vb)());let e={no_pindah:a.no_pindah,tanggal:a.tanggal,kode_lokasi_gudang:a.lokasi,kode_supplier:a.supplier,detail_barang:JSON.parse(localStorage.getItem("KonversiBarang_temp"))||[]};console.log(e);const t=[];JSON.parse(localStorage.getItem("KonversiBarang_temp")).forEach((a,e)=>{const n=[++e,a.kode_asal,a.qty_asal,a.kode_tujuan,a.qty_tujuan];t.push(n)});let n=["NO","KODE ASAL","QTY","KODE TUJUAN","QTY"];Object(_.c)("konversi-barang/post-transaksi",e).then(()=>Object(S.a)("Tanggal",a.tanggal,"","","No Bukti",a.no_pindah,"","","ADMIN","01-28-2021","ADMIN",n,"KONVERSI BARANG",t,[],!1)).then(()=>Object(d.b)("Berhasil Konversi barang")).then(()=>Object(O.d)(["no_pindah","lokasi_pilihan","supplier_pilihan","KonversiBarang_temp"])).then(()=>this.props.dispatch(Object(j.i)())).then(()=>this.props.dispatch(Object(v.a)("permintaanBarang"))).then(()=>this.props.dispatch(Object(b.Ub)())).catch(a=>Object(d.h)("Error : ".concat(a)).then(()=>this.props.dispatch(Object(b.Ub)())))}render(){return s.a.createElement("div",null,s.a.createElement("ol",{className:"breadcrumb float-xl-right"},s.a.createElement("li",{className:"breadcrumb-item"},s.a.createElement(l.b,{to:"#"},"Data Master")),s.a.createElement("li",{className:"breadcrumb-item active"},"Konversi Barang")),s.a.createElement("h1",{className:"page-header"},"Konversi Barang "),s.a.createElement(u.a,null,s.a.createElement(u.c,null,"Konversi Barang"),s.a.createElement(u.b,null,s.a.createElement("br",null),s.a.createElement("div",{className:"col-lg-12"},s.a.createElement(k,{onSubmit:a=>this.sendData(a)})),s.a.createElement("div",{className:"col-lg-12"},s.a.createElement(N.a,{empty:!0,data:this.props.konversi_temp,columns:this.state.columns,keyField:"kode_asal",textEmpty:"Silahkan pilih Lokasi -> lalu pilih Supplier -> lalu tambah barang"})),s.a.createElement("br",null),s.a.createElement(m.a,{title:this.state.isEdit?"Edit Data Permintaan Barang":"Tambah Data Barang",content:s.a.createElement(n.Suspense,{fallback:s.a.createElement(p.a,{width:"100%",height:50,count:2})},s.a.createElement(f,{onSubmit:a=>this.handleSubmit(a),onSend:this.props.onSend,isEdit:this.state.isEdit}))}))))}})}}]);
//# sourceMappingURL=110.d4cb488b.chunk.js.map