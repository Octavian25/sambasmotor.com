(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{1036:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),l=a(7),s=a(41),o=a(131),p=a(49),i=a(197),c=a(503),u=a(27),d=a(22),h=a(134),b=a(28),m=a(9),_=a(33),g=a(5);const S=Object(r.lazy)(()=>a.e(17).then(a.bind(null,1003))),k=Object(r.lazy)(()=>a.e(43).then(a.bind(null,1004)));class O extends r.Component{constructor(e){super(e),this.state={}}componentDidMount(){this.props.dispatch(Object(u.y)()),this.getKodeReturn()}handleHead(e){this.props.dispatch(Object(g.Xb)());let t={no_retur_supplier:e.kode_return,tanggal_retur:e.tanggal,no_bon:e.no_bon,kode_supplier:e.kode_supplier,keterangan:e.keterangan,diskon_rp:e.discount||0,detail_barang:JSON.parse(localStorage.getItem("ReturnSupplier_temp_kirim"))||[]};console.log(JSON.stringify(t));const a=[],r=[];let n=JSON.parse(localStorage.getItem("ReturnSupplier_temp"));n.forEach((e,t)=>{const r=[++t,e.kode_barcode,e.nama_barang,e.merk,e.kwalitas,e.type,e.satuan,e.qty,parseFloat(e.harga_satuan).toLocaleString("id-ID"),parseFloat(e.total).toLocaleString("id-ID")];a.push(r)});const l=["","","","","","","","","TOTAL TAGIHAN",parseFloat(n.map(e=>e.total).reduce((e,t)=>e+t,0)).toLocaleString("id-ID")];r.push(l);let s=["NO","BARCODE","JENIS BARANG","MERK","KW","TYPE","SATUAN","QTY","HARGA SATUAN","TOTAL"];Object(m.c)("retur-barang-supplier/post-transaksi",t).then(()=>Object(b.b)("Berhasil")).then(()=>Object(h.a)("NO RETURN",e.kode_return,"TANGGAL",e.tanggal,"NO BON",e.no_bon,"SUPP",e.kode_supplier,Object(b.l)().user_name,"01-28-2021",Object(b.l)().user_name,s,"BUKTI RETURN BARANG SUPPLIER",a,r,!0)).then(()=>Object(_.d)(["ReturnSupplier_temp","ReturnSupplier_temp_kirim","return_supplier","return_keterangan","return_tanggal_bon","return_kode"])).then(()=>this.props.dispatch(Object(p.a)("HeadSupplierPenerimaan"))).then(()=>this.getKodeReturn()).then(()=>this.props.dispatch(Object(u.y)())).then(()=>this.props.dispatch(Object(g.Wb)())).then(()=>window.location.reload()).catch(e=>Object(b.a)(e.response.data).then(()=>this.props.dispatch(Object(g.Wb)())))}getKodeReturn(){Object(m.b)("retur-barang-supplier/generate/no-trx").then(e=>localStorage.setItem("kode_return",e.data[0].no_retur_supplier)).catch(e=>console.log(e))}handleModal(e){let t=JSON.parse(localStorage.getItem("ReturnSupplier_temp_kirim"))||[],a=JSON.parse(localStorage.getItem("ReturnSupplier_temp"))||[],r=t.findIndex(t=>t.kode_barcode===e.kode_barcode),n=a.findIndex(t=>t.kode_barcode===e.kode_barcode);if(-1!==r){let l={kode_barcode:e.kode_barcode,qty:parseInt(e.qty)+parseFloat(t[r].qty),harga_satuan:parseFloat(e.harga_satuan),harga_total:parseFloat(e.total)+parseFloat(t[r].harga_total)},s={harga_satuan:e.harga_satuan,kode_barcode:e.kode_barcode,kwalitas:e.kwalitas,merk:e.merk,nama_barang:e.nama_barang,qty:parseFloat(e.qty)+parseFloat(a[n].qty),satuan:e.satuan,total:parseFloat(e.total)+parseFloat(a[n].total),type:e.type};t.splice(r,1),a.splice(n,1),t.push(l),a.push(s),localStorage.setItem("ReturnSupplier_temp",JSON.stringify(a)),localStorage.setItem("ReturnSupplier_temp_kirim",JSON.stringify(t)),Object(b.b)("Berhasil"),this.props.dispatch(Object(p.a)("ModalReturnSupplier")),this.props.dispatch(Object(u.y)())}else{let t={kode_barcode:e.kode_barcode,qty:parseInt(e.qty),harga_satuan:parseFloat(e.harga_satuan),harga_total:parseFloat(e.total)},a={harga_satuan:e.harga_satuan,kode_barcode:e.kode_barcode,kwalitas:e.kwalitas,merk:e.merk,nama_barang:e.nama_barang,qty:e.qty,satuan:e.satuan,total:e.total,type:e.type};Object(c.a)("ReturnSupplier_temp",a).then(()=>this.props.dispatch(Object(p.a)("ModalReturnSupplier"))).then(()=>this.props.dispatch(Object(u.y)())),Object(c.a)("ReturnSupplier_temp_kirim",t).then(()=>this.props.dispatch(Object(p.a)("ModalReturnSupplier"))).then(()=>this.props.dispatch(Object(u.y)()))}}render(){return n.a.createElement("div",null,n.a.createElement("ol",{className:"breadcrumb float-xl-right"},n.a.createElement("li",{className:"breadcrumb-item"},n.a.createElement(l.b,{to:"#"},"Transaksi")),n.a.createElement("li",{className:"breadcrumb-item active"},"Return Barang Supplier")),n.a.createElement("h1",{className:"page-header"},"Return Barang Supplier"),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-lg-12"},n.a.createElement(s.a,null,n.a.createElement(s.c,null,"Return Barang Supplier"),n.a.createElement(s.b,null,n.a.createElement("br",null),n.a.createElement("div",{className:"col-lg-12"},n.a.createElement(S,{onSubmit:e=>this.handleHead(e),listreturnsupplier:this.props.listreturnsupplier,sub_total:this.props.sub_total})),n.a.createElement("br",null))),n.a.createElement(o.a,{title:"Return Barang Supplier",content:n.a.createElement(k,{onSubmit:e=>this.handleModal(e)})}))))}}O=Object(i.a)({form:"SupplierPenerimaan",enableReinitialize:!0})(O),t.default=Object(d.b)(e=>({listreturnsupplier:e.transaksi.listreturnsupplier,sub_total:e.transaksi.sub_total}),null)(O)},503:function(e,t,a){"use strict";a.d(t,"a",function(){return l});var r=a(16),n=a.n(r);const l=(e,t)=>new Promise((a,r)=>{let l=JSON.parse(localStorage.getItem(e))||[];l.push(t),localStorage.setItem(e,JSON.stringify(l)),n.a.fire({position:"top-right",text:"Tambah Data Berhasil",timer:2e3,icon:"success",showConfirmButton:!1}).then(()=>a("Berhaisl")).catch(()=>r("GAGAL"))})}}]);
//# sourceMappingURL=47.6c8aa8ac.chunk.js.map